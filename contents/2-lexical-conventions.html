<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>2.词法约定</title>
  </head>
  
  <body>
    <h1>词法约定</h1>
    <p>[略...]形式化的语法请参见7.1章.</p>
    
    <h2>标示符</h2>
    <div>
      <p>一个标示符是一串满足以下两个条件的字符序列:由字母,数字,和"扩展标示符字符"构成;不以数字开头.然而,在表的语法中, . (一个句号)不是标示符.</p>
      <p>所有scheme实现应当支持以下扩展标示符字符:</p>
      <p>! $ % &amp; * + - . / : &lt; = &gt; ? @ ^ _ ~</p>
      <p>此外,所有标示符都可以用以竖线(|)包裹的字符序列(允许长度为0)来表示,就像字符串一样.任何字符,包括空白符,但除了反斜线(\ 也叫转义符)和竖线(|),都能直接出现在这类标示符中.另外,字符可以通过&lt;inline hex escape&gt;(16进制编码)来指明,或者像在<strong>字符串</strong>中那样转义</p>
      <p>例如,标示符|H\x64;llo|与Hello相同,在支持Unicode实现中,|\x3BB;|和λ等价.此外,|\t\t|和|\x9;\x9;|是相同的.需要注意的是,||是一个合法的(且与众不同的)标示符.</p>
      <p>以下是一些标示符示例.</p>
      <table>
	<tr>
	  <td>...</td>
	  <td>+</td>
	</tr>
	<tr>
	  <td>+soup+</td>
	  <td>&lt;=?</td>
	</tr>
	<tr>
	  <td>-&gt;string</td>
	  <td>a34kTMNs</td>
	</tr>
	<tr>
	  <td>lambda</td>
	  <td>list->&gt;vector</td>
	</tr>
	<tr>
	  <td>q</td>
	  <td>V17a</td>
	</tr>
	<tr>
	  <td>|two words|</td>
	  <td>|two\x20;words|</td>
	</tr>
	<tr>
	  <td colspan="2">the-world-recursion-has-many-meanings</td>
	</tr>
      </table>
      <p>标示符的形式化语法请参见7.1.1.</p>
      <p>标示符在scheme程序中有两个应用:</p>
      <ul>
	<li>用作变量或语法关键词.(参见3.1和4.3章)</li>
	<li>当一个标示符以字面量形式出现或出现在字面量之中时(参见4.1.2),它被用来表示符号数据(参见6.5).</li>
      </ul>
      <p>与此报告的早期版本不同的是,标示符和字符名称表示(characters specified using their names)的语法区分大小写.然而,它并不区分数字或&lt;inline hex escapes&gt;的大小写,无论它们被用在标示符,字符,或字符串中.本报告内定义的标示符并不含有大写字符,即便在按照英语的习惯应该大写的位置也是如此.</p>
      <p>以下<strong>指示</strong>(directives)可以控制是否区分大小写:</p>
      <table>
	<tr><td>#!fold-case</td></tr>
	<tr><td>#!no-fold-case</td></tr>
      </table>
      <p>这些<strong>指示</strong>可以出现在任何一个<strong>注释</strong>可以出现的地方(参见2.2)但一定要紧接着一个分隔符.它们被视作注释,唯一的不同是它们会影响接下来同端口的数据读取过程.#!fold-case指示令接下来读取的标示符和字符名(character names)全部转化为小写,和string-foldcase效果一样(参见6.7).但它对字符字面量没有影响.#!no-fold-case指示令行为回归默认值,即区分大小写.</p>
    </div>
    
    <h2>空白和注释</h2>
    <div>
      <p>空白字符包括:空格(space),制表符(tab),和换行符(newline).(实现可以根据需要支持而外的空白字符,例如分页符.)空白字符用于提高可读性和必要地相互分隔<em>符记</em>(符记是独立的词法单元,例如一个标示符或者数字),其余情况下是不重要的.空白字符可以出现在两个<em>符记</em>之间,但不能在一个<em>符记</em>里面.出现在字符串或由竖线标记的符号中的空白字符是有意义的.</p>
      <p>词汇语法中包括数种注释形式.注释被视作空白.</p>
      <p>[本章节剩余内容以简略的形式表述]</p>
      <p>单行注释: 分号(;)开始至行尾.</p>
      <p>单对象(datum,直译是数据,资料)(参见7.1.2)注释:在对象前面添加#;,中间可以包含空白.</p>
      <p>块注释:#|注释内容|#</p>
      <p>[示例省略]</p>
    </div>
    
    <h2>其他记号</h2>
    <div>
      <p>关于用于数字的记号说明,参见6.2.</p>
      <table>
	<tr>
	  <td>. + -</td>
	  <td>这些被用于数字中,而且可以出现在标示符的任意位置.一个单独的加(减)号也是一个标示符.一个单独的句号被用于点对的表示法(参见6.4),和在(lambda表达式的)形式参数列表中表示剩余参数(参见4.1.4).需要注意的是,句号序列是<em>一个</em>标示符.</td>
	</tr>
	<tr>
	  <td>( )</td>
	  <td>括号用于住值和表示表(参见6.4).</td>
	</tr>
	<tr>
	  <td>'</td>
	  <td>撇号(单引号)用于表示字面数据(参见4.1.2)</td>
	</tr>
	<tr>
	  <td>`</td>
	  <td>重音符(反括号)用于表示部分常量数据(4.2.8).</td>
	</tr>
	<tr>
	  <td>, ,@</td>
	  <td>引号和引号接着单价符号(at符号)搭配准引用(quasiquotation)使用(4.2.8).</td>
	</tr>
	<tr>
	  <td>""</td>
	  <td>引号用于定界string(6.7).</td>
	</tr>
	<tr>
	  <td>\</td>
	  <td>反斜线可用于字符常量(6.6),也可在字符串常量(6.6)和符号(6.7)中表示逃逸符.</td>
	</tr>
	<tr>
	  <td>[ ] { }</td>
	  <td>左右方(花)括号为将来的语言扩展保留.</td>
	</tr>
	<tr>
	  <td>#</td>
	  <td>数字符号(井号)因紧接着它的字符不同而有不同功能.</td>
	</tr>
	<tr>
	  <td>#t #f</td>
	  <td>它们是布尔值常量(6.3),也可用#true和#false表示.</td>
	</tr>
	<tr>
	  <td>#\</td>
	  <td>它引入字符常量(6.6).</td>
	</tr>
	<tr>
	  <td>#(</td>
	  <td>它引入向量常量(6.8).向量常量以)为终止符.</td>
	</tr>
	<tr>
	  <td>#u8(</td>
	  <td>它引入比特向量常量(6.9).比特向量常量以)为终止符.</td>
	</tr>
	<tr>
	  <td>#e #i #b #o #d #x</td>
	  <td>它们被用于数字的表示法.</td>
	</tr>
	<tr>
	  <td>#&lt;n&gt;= #&lt;n&gt;#</td>
	  <td>它们被用于标记和引用其他字面数据(2.4).</td>
	</tr>
      </table>
    </div>
    
    <h2>数据标签</h2>
    <div>
      <table>
	<tr>
	  <td>#&lt;n&gt;=&lt;datum&gt;</td>
	  <td>lexical syntax</td>
	</tr>
	<tr>
	  <td>#&lt;n&gt;#</td>
	  <td>lexical syntax</td>
	</tr>
      </table>
      <p>词汇语法#&lt;n&gt;=&lt;datum&gt;的读取结果和&lt;datum&gt;一样,但会给&lt;datum&gt;加上一个&lt;n&gt;标签.如果&lt;n&gt;不是数字序列,将会引发错误.</p>
      <p>&lt;n&gt;可以引用被#&lt;n&gt;=标记的对象,得到与原对象<em>相同</em>的对象.</p>
      <p>在它们的协作之下,可以用来表示包含共有数据,或环状数据的数据结构.</p>
      <p>
	(let ((x (list 'a 'b 'c)))
	  (set-cdr! (cddr x) x)
	  x)                         ==&gt; #0=(a b c . #0#)
      </p>
      <p>数据标签的作用域是从标签被定义的位置开始,包括整个对象的内部.所以,一个引用#&lt;n&gt;#只能出现在标签#&lt;n&gt;=之后.</p>
      <p>程序或库中在非字面数据的位置包含环状引引用是一个错误.特别的是,在准引用(4.2.8)中包含它们也是错误.</p>
      <p>#1=(begin (display #\x) #1#) ==&gt; error</p>
    </div>
  </body>
</html>
